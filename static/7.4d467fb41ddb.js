webpackJsonp([7],{1:function(t,e){var a=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=a)},4:function(t,e,a){t.exports={"default":a(7),__esModule:!0}},6:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={props:{type:{"default":"default"},disabled:{type:Boolean,"default":!1},mini:{type:Boolean,"default":!1},plain:{type:Boolean,"default":!1},text:String},computed:{classes:function(){return[{weui_btn_disabled:this.disabled,weui_btn_mini:this.mini},"weui_btn_"+this.type,this.plain?"weui_btn_plain_"+this.type:""]}}}},7:function(t,e,a){var s=a(1),n=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},10:function(t,e){t.exports=" <button class=weui_btn :class=classes :disabled=disabled> {{text}}<slot></slot> </button> "},11:function(t,e,a){var s,n;s=a(6),n=a(10),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},39:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e,a){p["default"].log("addCard","invoking wx:"+(0,u["default"])(t)),wx.addCard({cardList:t,success:function(t){p["default"].log("addCard","add card success:"+t+", json:"+(0,u["default"])(t.cardList)),e&&e(t.cardList)},cancel:function(t){a&&a()},fail:function(t){a&&a()}})}function o(t,e,a,s,o,d){t.$http.post(s+"weixin/card/add",{card_global_id:e,openid:a}).then(function(t){var a=t.data;if(0==a.result){var s=a.data,i=[];i.push({cardId:s.id,cardExt:'{"timestamp":"'+s.timestamp+'","signature":"'+s.signature+'"}'}),n(i,o,d)}else p["default"].log("wxAddCard","post add-card:"+e+" failed"),d&&d()},function(){p["default"].log("wxAddCard","post add-card:"+e+" exception"),d&&d()})}function d(t,e,a,s,o,d){t.$http.post(s+"weixin/cards/add",{orderId:e,openid:a}).then(function(t){var a=t.data;if(0==a.result){for(var s=a.data,i=[],r=0;r<s&&s.length;r++){var u=s[r];i.push({cardId:u.id,cardExt:'{"timestamp":"'+u.timestamp+'","signature":"'+u.signature+'"}'})}n(i,o,d)}else p["default"].log("wxAddCards","post add-cards order:"+e+" failed"),d&&d()},function(){p["default"].log("wxAddCards","post add-cards order:"+e+" exception"),d&&d()})}function i(t,e,a,s,n){p["default"].log("wxOpenCard","cardId:"+e+" code:"+a),wx.openCard({cardList:[{cardId:e,code:a}],success:function(t){var e=t.cardList;p["default"].log("wxOpenCard","card list:"+e),s&&s(e)},cancel:function(t){n&&n()},fail:function(t){n&&n()}})}Object.defineProperty(e,"__esModule",{value:!0});var r=a(4),u=s(r);e.wxAddCard=o,e.wxAddCards=d,e.wxOpenCard=i;var c=a(3),p=s(c)},128:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(39),o=a(2),d=s(o),i=a(16),r=s(i),u=a(3),c=s(u);e["default"]={attached:function(){this.$root.navTitle="电子卡接收",this.$root.showHeader=!0},components:{XButton:a(11)},data:function(){return{no_data:!1,info:{giveUserHeadImg:"/static/images/ico-head.png",giveUsername:"",shareContent:"",cardStatus:0,giveStatus:0,acquireUserOpenId:""},statusStr:""}},methods:{goHome:function(){this.$route.router.go({name:"home"})},goBuy:function(){this.$route.router.go({name:"buy"})},onReceiveCard:function(){var t=this;t.$dispatch("showLoading"),c["default"].log("CardGiftReceive"," openid:"+t.openid+" sign:"+t.sign),this.$http.post(d["default"].API_URL+"card/receive",{openId:t.openid,sign:t.sign}).then(function(e){t.$dispatch("hideLoading");var a=e.data;return c["default"].log("CardGiftReceive","ack status:"+a.result),255==a.result?void t.$route.router.go({name:"memcards"}):void(1==a.data.status?(0,n.wxOpenCard)(t,a.data.wxCardId,a.data.code,function(e){t.$route.router.go({name:"memcards"})},function(){t.$route.router.go({name:"memcards"})}):(0,n.wxAddCard)(t,a.data.cardGlobalId,t.openid,d["default"].API_URL,function(e){t.$route.router.go({name:"memcards"})},function(){t.$route.router.go({name:"memcards"})}))},function(){t.$dispatch("hideLoading")})}},ready:function(){var t=this;t.$dispatch("showLoading"),this.$http.post(d["default"].API_URL+"card/receive/check",{openId:t.openid,sign:t.sign}).then(function(e){t.$dispatch("hideLoading");var a=e.data;return 255==a.result?void(t.no_data=!0):(t.info=a.data,c["default"].log("CardGiftReceive","myself:"+t.openid+" giving status:"+t.info.giveStatus+", card status:"+t.info.cardStatus),void(0==t.info.giveStatus?t.statusStr="领取电子卡":t.info.acquireUserOpenId!=t.openid?t.statusStr="已被领取":0==t.info.cardStatus?t.statusStr="已领取，未放入卡包":1==t.info.cardStatus?t.statusStr="已放入微信卡包未激活":2==t.info.cardStatus?t.statusStr="已放入微信卡包已激活":3==t.info.cardStatus?t.statusStr="已过期":4==t.info.cardStatus?t.statusStr="转赠中":t.statusStr="已转赠"))})},route:{data:function(t){this.openid=r["default"].wxOpenId,this.sign=t.to.params.sign}}}},208:function(t,e){t.exports=' <div> <div class=content> <div class=not_card v-show=no_data> <p class=ncd_p1><span class=ico_nocard></span></p> <p class=ncd_p2>赠送的电子卡不存在~~</p> <p class=ncd_p3> <x-button type=primary @click=goBuy>购买电子卡</x-button> <x-button @click=goHome>首页</x-button> </p> </div> <div v-show=!no_data> <div class=lk_top> <div class=lk_toux><span class=toux_img><img :src=info.giveUserHeadImg class=give-user></span></div> <p class=lk_tp1><em class=give-user-name>{{info.giveUsername}}</em>赠送的礼品卡</p> <p class="lk_tp2 give-content">{{info.shareContent}}</p> </div> <p class="lk_btn_p can-receive"> <x-button :type="info.giveStatus==0?\'primary\':\'\'" :disabled="info.giveStatus!=0" @click=onReceiveCard> {{statusStr}} </x-button> </p> <p class="lk_tit2 none"><span class="lk_cbox text-status"></span></p> </div> </div> </div> '},243:function(t,e,a){var s,n;s=a(128),n=a(208),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)}});