webpackJsonp([4],{1:function(e,t){var a=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=a)},4:function(e,t,a){e.exports={"default":a(7),__esModule:!0}},6:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={props:{type:{"default":"default"},disabled:{type:Boolean,"default":!1},mini:{type:Boolean,"default":!1},plain:{type:Boolean,"default":!1},text:String},computed:{classes:function(){return[{weui_btn_disabled:this.disabled,weui_btn_mini:this.mini},"weui_btn_"+this.type,this.plain?"weui_btn_plain_"+this.type:""]}}}},7:function(e,t,a){var n=a(1),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},10:function(e,t){e.exports=" <button class=weui_btn :class=classes :disabled=disabled> {{text}}<slot></slot> </button> "},11:function(e,t,a){var n,o;n=a(6),o=a(10),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),o&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=o)},40:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,a,n,o,r){c["default"].log("onMenuShareAppMessage","title:"+t+", wx:"+wx),wx.onMenuShareAppMessage({title:t,desc:a,link:e,imgUrl:n,success:function(){c["default"].log("onMenuShareAppMessage","success"),o&&o()},cancel:function(){c["default"].log("onMenuShareAppMessage","cancel"),r&&r()},fail:function(e){alert((0,d["default"])(e))}})}function r(e,t,a,n,o,r){wx.onMenuShareTimeline({title:t,link:e,desc:a,imgUrl:n,success:function(){c["default"].log("onMenuShareTimeline","success"),o&&o()},cancel:function(){c["default"].log("onMenuShareTimeline","cancel"),r&&r()}})}function s(e,t,a,n){var o=h["default"].wxConfigMode;if(o==t)return c["default"].log("wxRegister","discarded, wxConfig now mode:"+o+", input mode:"+t),void(a&&a());var r=location.href.split("#")[0];c["default"].log("wxRegister","register url:"+r),e.$http.post(p["default"].API_URL+"weixin/sign/jsapi",{url:r}).then(function(e){c["default"].log("wxRegister","jsapi response ok"),e&&e.data?(wx.config({debug:!1,appId:e.data.appId,timestamp:e.data.timestamp,nonceStr:e.data.nonceStr,signature:e.data.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","scanQRCode","openCard","addCard","chooseWXPay"]}),wx.ready(function(){c["default"].log("wxRegister","wx.config ok..."),h["default"].wxConfigModeSet(t),a&&a()}),wx.error(function(e){c["default"].log("wxRegister","wx config error:"+e.errMsg),n&&n()})):n&&n()},function(e){c["default"].err("wxRegister",e),n&&n()})}Object.defineProperty(t,"__esModule",{value:!0});var i=a(4),d=n(i);t.onMenuShareAppMessage=o,t.onMenuShareTimeline=r,t.wxRegister=s;var u=a(3),c=n(u),l=a(2),p=n(l),f=a(16),h=n(f)},56:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(57),r=n(o);t["default"]={mixins:[r["default"]],props:{required:{type:Boolean,"default":!0}},created:function(){this.handleChangeEvent=!1},computed:{dirty:function(){return!this.prisine},invalid:function(){return!this.valid}},methods:{setTouched:function(){this.touched=!0}},watch:{value:function(e){this.prisine===!0&&(this.prisine=!1),this.handleChangeEvent||this.$emit("change",e)}},data:function(){return{errors:{},prisine:!0,touched:!1,valid:!0}}}},57:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={created:function(){this.uuid=Math.random().toString(36).substring(3,8)}}},123:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(56),r=n(o);t["default"]={minxins:[r["default"]],props:{showCounter:{type:Boolean,"default":!0},max:Number,value:{type:String,"default":"",twoWay:!0},placeholder:{type:String,"default":""},rows:{type:Number,"default":3},cols:{type:Number,"default":30},height:Number},watch:{value:function(e){this.max&&this.value.length>this.max&&(this.value=e.slice(0,this.max)),this.$emit("on-change",this.value)}},computed:{count:function(){return this.value.length},textareaStyle:function(){if(this.height)return{height:this.height+"px"}}}}},129:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(4),r=n(o),s=a(2),i=n(s),d=a(16),u=n(d),c=a(3),l=n(c),p=a(40);t["default"]={attached:function(){this.$root.navTitle="电子卡分享",this.$root.showHeader=!0},components:{XButton:a(11),XTextarea:a(238)},data:function(){return{cardId:"",cardCode:"",content:"小小卡片，浓浓情义",shareUrl:"",card:{sign:"",cardId:"",cardName:"",timestamp:""},logo:"http://wx.cdn.pipapay.com/static/images/pipalogo-blue2.png"}},route:{data:function(e){this.openid=u["default"].wxOpenId,this.cardId=e.to.params.cardId,this.cardCode=e.to.params.cardCode}},methods:{updateCardStatus:function(){var e=this;this.$http.post(i["default"].API_URL+"card/share",{openId:e.openid,sign:e.card.sign,cardId:e.cardId,cardCode:e.cardCode,timestamp:e.card.timestamp,content:e.content}).then(function(t){var a=t.data;0==a.result&&e.$route.router.go({name:"gift_share_result",params:{cardId:e.cardId,cardCode:e.cardCode}})})},onShare:function(){var e=this;e.shareUrl="http://"+location.host+"/#!/gift/receive/"+e.card.sign,l["default"].log("CardGiftShare","onShare url:"+e.shareUrl+" card:"+e.card.cardName),(0,p.onMenuShareAppMessage)(e.shareUrl,e.content,"点击领取"+e.card.cardName,e.logo,function(){l["default"].log("CardGiftShare"," menu share ok"),e.maskShow=!1,e.updateCardStatus()},function(){e.maskShow=!1,l["default"].log("CardGiftShare","menu share cancel or error")})},onShareButton:function(){this.maskShow=!0,this.onShare()}},ready:function(){var e=this;e.$dispatch("showLoading"),e.$http.post(i["default"].API_URL+"card/share/check",{openId:e.openid,cardId:e.cardId,cardCode:e.cardCode}).then(function(t){e.$dispatch("hideLoading");var a=t.data;return l["default"].log("CardGiftShare","card sharing check result:"+(0,r["default"])(a)),0!=a.result?void e.$dispatch("alert",254==a.result?"此卡还未与微信卡包绑定":"此卡不存在",function(){e.$route.router.go({name:"home"})}):a.status>2?void e.$dispatch("alert","此卡已转赠",function(){e.$route.router.go({name:"home"})}):(l["default"].log("CardGiftShare","card sharing check ok"),e.card=a.card,void(0,p.wxRegister)(e,"index",function(){e.onShare()}))},function(){e.$dispatch("hideLoading"),l["default"].log("CardGiftShare","card sharing check exception")})}}},204:function(e,t){e.exports=' <div class=weui_cell> <div class="weui_cell_bd weui_cell_primary"> <textarea class=weui_textarea placeholder={{placeholder}} :rows=rows :cols=cols v-model=value :style=textareaStyle :maxlength=max></textarea> <div class=weui_textarea_counter v-show="showCounter && max"><span>{{count}}</span>/{{max}}</div> </div> </div> '},209:function(e,t){e.exports=' <div class="wx-cards card gift"> <div class=container data-js=""> <div class=content> <p class=donation_top>请输入转赠留言</p> <div class="donation_text border b_top_btm"> <x-textarea :max=15 :placeholder=content :value.sync=content></x-textarea> </div> <p class=donation_btn> <x-button type=primary @click=onShareButton>转赠</x-button> </p> <p class=donation_p1>温馨提示</p> <p class=donation_p2><span>1.</span> <span>转赠后，礼品卡即处于“转赠中”状态。待好友领取后，即与转赠者解绑，并与被转赠者建立绑定关系。</span></p> <p class=donation_p2><span>2.</span> <span>若超过24小时未领取。则过期不可再领取。同时礼品卡从“转赠中”状态恢复正常。</span></p> </div> <div class="s_wraper share_id" v-show=maskShow @click="maskShow=false"> <div class=pop_otop> <p class=box_share><span class=ico_share></span></p> </div> </div> </div> </div> '},238:function(e,t,a){var n,o;n=a(123),o=a(204),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),o&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=o)},244:function(e,t,a){var n,o;n=a(129),o=a(209),e.exports=n||{},e.exports.__esModule&&(e.exports=e.exports["default"]),o&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=o)}});